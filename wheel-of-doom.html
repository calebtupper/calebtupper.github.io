<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="description" content="Wheel of Doom is a fun interactive game where you spin a wheel to get random challenges or tasks.">
    <meta name="keywords" content="Wheel of Doom, interactive game, spin the wheel, challenges, tasks">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="favicon.ico" type="image/gif" sizes="16x16">
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=League+Script&family=Montserrat:ital,wght@0,300;0,500;1,300;1,500&family=Roboto:ital,wght@0,300;0,500;0,700;1,300;1,500;1,700&display=swap" rel="stylesheet">
    <script type="text/javascript" src="assets/js/jquery-3.5.1.min.js"></script>
    <script tyle="text/javascript" src="assets/js/script.js"></script>
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-NL29ZKK');</script>
    <!-- End Google Tag Manager -->
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Wheel of Doom</title>
    <style>
  body {
    background: radial-gradient(circle at center, #1a1a1a, #000);
    color: white;
    font-family: 'Trebuchet MS', sans-serif;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    min-height: 100vh;
    margin: 0;
  }
  h1 {
    font-size: 2.5rem;
    margin-top: 20px;
    margin-bottom: 10px;
    text-shadow: 2px 2px 8px #ff0000;
  }
  canvas {
    border-radius: 50%;
    border: 12px solid black;
    box-shadow: 0 0 40px red, inset 0 0 30px red;
    background-color: #d4b483;
  }
  button {
    margin-top: 10px;
    padding: 10px 18px;
    font-size: 1.1rem;
    background: linear-gradient(45deg, #ff0000, #ff6600);
    color: white;
    border: none;
    border-radius: 10px;
    cursor: pointer;
    transition: 0.3s;
  }
  button:hover {
    background: linear-gradient(45deg, #ff6600, #ff0000);
  }
  #result {
    margin-top: 15px;
    font-size: 1.4rem;
    text-shadow: 1px 1px 4px black;
    min-height: 40px;
    text-align: center;
  }
  #editor {
    margin-top: 15px;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 5px;
    width: 90%;
    max-width: 500px;
  }
  textarea {
    width: 100%;
    height: 100px;
    border-radius: 8px;
    padding: 8px;
    font-size: 1rem;
    resize: vertical;
  }
  canvas {
  border-radius: 50%;
  border: 12px solid black;
  box-shadow: 0 0 40px red, inset 0 0 30px red;
  background-color: #d4b483;
  width: 90vw;
  max-width: 500px;
  height: 90vw;
  max-height: 500px;
  display: block;
}
  footer {
    width: 100%;
    background-color: #111;
    color: #aaa;
    padding: 20px 10px;
    text-align: center;
    font-size: 0.9rem;
    margin-top: auto;
  }
  footer a {
    color: #ff4c4c;
    text-decoration: none;
  }
  footer a:hover {
    text-decoration: underline;
  }
</style>
</head>
<body>
  <h1>Wheel of Doom</h1>
  <canvas id="wheelCanvas"></canvas>
  <button id="spinBtn">SPIN THE WHEEL</button>
  <div id="result"></div>

  <div id="editor">
    <label for="segments">Edit Wheel Segments (one per line):</label>
    <textarea id="segments"></textarea>
    <button id="updateBtn">Update Wheel</button>
  </div>
<footer>
            <div class="container">
                <!--<div class="social-light">
                    <a href="https://www.linkedin.com/in/calebtupper/" target="_blank" role="link"><img src="/assets/img/web-icons/linkedin.png" alt="LinkedIn" /></a>
                    <a href="https://www.instagram.com/caleb.tupper/" target="_blank" role="link"><img src="/assets/img/web-icons/instagram.png" alt="Instagram" /></a>
                </div>
                <div class="social-dark">
                    <a href="https://www.linkedin.com/in/calebtupper/" target="_blank" role="link"><img src="/assets/img/web-icons/linkedin-white.png" alt="LinkedIn" /></a>
                    <a href="https://www.instagram.com/caleb.tupper/" target="_blank" role="link"><img src="/assets/img/web-icons/instagram-white.png" alt="Instagram" /></a>
                </div>-->
                <ul style="color: #fefefe;">
                    <li><a href="/" role="link">Home</a></li>
                    <li><a href="/contact" role="link" target="_blank">Contact</a></li>
                    <li><a href="https://www.linkedin.com/in/calebtupper/" role="link" target="_blank">LinkedIn</a></li>
                    <li><a href="/privacy" role="link" target="_blank">Privacy</a></li>
                </ul>
                <br />
                <p class="tac">&copy; Caleb Tupper <span id="year"></span></p>
            </div>
        </footer>
        <!-- Start of HubSpot Embed Code -->
        <script type="text/javascript" id="hs-script-loader" async defer src="//js.hs-scripts.com/47121988.js"></script>
        <!-- End of HubSpot Embed Code -->
<script>
const SEGMENTS_KEY = "wheelSegments";
const SEGMENTS_EXP_KEY = "wheelSegmentsExp";
const SEGMENTS_EXP_DAYS = 30;

// Load segments from localStorage if not expired
function loadSegments() {
  const exp = localStorage.getItem(SEGMENTS_EXP_KEY);
  const now = Date.now();
  if (exp && now < parseInt(exp, 10)) {
    const cached = localStorage.getItem(SEGMENTS_KEY);
    if (cached) {
      return JSON.parse(cached);
    }
  }
  return [
    "Run on fumes",
    "Airplane mode all day",
    "Separate and find each other",
    "Only $10 for food",
    "Walk everywhere",
    "No technology for 24h",
    "Random act of kindness",
    "Give away your meal"
  ];
}

// Save segments to localStorage with expiration
function saveSegments(segments) {
  localStorage.setItem(SEGMENTS_KEY, JSON.stringify(segments));
  localStorage.setItem(SEGMENTS_EXP_KEY, Date.now() + SEGMENTS_EXP_DAYS * 24 * 60 * 60 * 1000);
}

// Use cached or default segments
let wheelSegments = loadSegments();


let colors = ["#e5c07b", "#d4b483"];
let clickSound = new Audio("https://cdn.pixabay.com/audio/2022/03/15/audio_ae1cb0d57d.mp3");

const canvas = document.getElementById("wheelCanvas");
const ctx = canvas.getContext("2d");
const spinBtn = document.getElementById("spinBtn");
const updateBtn = document.getElementById("updateBtn");
const resultDiv = document.getElementById("result");
const segmentsTextarea = document.getElementById("segments");

let startAngle = 0;
let spinTimeout = null;
let spinAngleStart = 0;
let spinTime = 0;
let spinTimeTotal = 0;
let lastSegment = -1;

function resizeCanvas() {
  const size = Math.min(window.innerWidth * 0.9, 500);
  canvas.width = size;
  canvas.height = size;
}
window.addEventListener("resize", () => {
  resizeCanvas();
  drawWheel();
});
resizeCanvas();
drawWheel();

function drawWheel() {
  const center = canvas.width / 2;
  const radius = center - 10;
  const arc = Math.PI / (wheelSegments.length / 2);
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  // Draw segments
  for (let i = 0; i < wheelSegments.length; i++) {
    const angle = startAngle + i * arc;
    ctx.fillStyle = colors[i % colors.length];
    ctx.beginPath();
    ctx.moveTo(center, center);
    ctx.arc(center, center, radius, angle, angle + arc, false);
    ctx.lineTo(center, center);
    ctx.fill();

    // Draw segment text (responsive font size)
    ctx.save();
    const textRadius = radius * 0.62;
    ctx.translate(center + Math.cos(angle + arc / 2) * textRadius, center + Math.sin(angle + arc / 2) * textRadius);
    ctx.rotate(angle + arc / 2);
    ctx.textAlign = "center";
    ctx.textBaseline = "middle";
    ctx.font = `bold ${Math.max(12, radius * 0.09)}px Arial`; // Responsive font size for segments
    ctx.fillStyle = "black";
    ctx.fillText(wheelSegments[i], 0, 0);
    ctx.restore();
  }

// Draw center box
  const boxSize = radius * 0.6; // Smaller box for mobile
  ctx.beginPath();
  ctx.fillStyle = "#222";
  ctx.strokeStyle = "red";
  ctx.lineWidth = Math.max(2, radius * 0.016);
  ctx.rect(center - boxSize / 2, center - boxSize / 2, boxSize, boxSize);
  ctx.stroke();
  ctx.fill();

  // Draw "DOOM" text (responsive font size)
  ctx.fillStyle = "white";
  ctx.font = `bold ${Math.max(18, radius * 0.13)}px Arial`; // Adjust font size for smaller box
  ctx.textAlign = "center";
  ctx.textBaseline = "middle";
  ctx.fillText("DOOM", center, center);

  // Draw pointer
  ctx.fillStyle = "red";
  ctx.beginPath();
  ctx.moveTo(center - radius * 0.05, radius * 0.08);
  ctx.lineTo(center + radius * 0.05, radius * 0.08);
  ctx.lineTo(center, radius * 0.2);
  ctx.closePath();
  ctx.fill();
}

function rotateWheel() {
  spinTime += 30;
  if (spinTime >= spinTimeTotal) {
    stopRotateWheel();
    return;
  }
  const spinAngle = easeOutCubic(spinTime, spinAngleStart, -spinAngleStart, spinTimeTotal);
  startAngle += (spinAngle * Math.PI) / 180;
  drawWheel();

  const arc = (Math.PI * 2) / wheelSegments.length;
  const currentSegment = Math.floor(((startAngle % (Math.PI * 2)) + Math.PI * 2) % (Math.PI * 2) / arc);

  if (currentSegment !== lastSegment) {
    let slowdownFactor = 1 - (spinTime / spinTimeTotal);
    clickSound.playbackRate = Math.max(0.5, slowdownFactor * 1.5);
    clickSound.currentTime = 0;
    clickSound.play();
    lastSegment = currentSegment;
  }

  spinTimeout = requestAnimationFrame(rotateWheel);
}

function stopRotateWheel() {
  cancelAnimationFrame(spinTimeout);
  const arc = Math.PI / (wheelSegments.length / 2);
  const degrees = (startAngle * 180) / Math.PI + 90;
  const arcd = (arc * 180) / Math.PI;
  const index = Math.floor((360 - (degrees % 360)) / arcd);
  resultDiv.innerHTML = `Result: <strong>${wheelSegments[index]}</strong>`;
}

function easeOutCubic(t, b, c, d) {
  t /= d;
  t--;
  return c * (t * t * t + 1) + b;
}

spinBtn.addEventListener("click", () => {
  spinAngleStart = Math.random() * 15 + 25;
  spinTime = 0;
  spinTimeTotal = 10000; // Spins for twice as long
  lastSegment = -1;
  rotateWheel();
}); // <-- Remove stray 's' here

updateBtn.addEventListener("click", () => {
  const newSegments = segmentsTextarea.value.split("\n").map(s => s.trim()).filter(s => s);
  if (newSegments.length > 0) {
    wheelSegments = newSegments;
    saveSegments(wheelSegments); // Save to localStorage
    drawWheel();
  }
});

segmentsTextarea.value = wheelSegments.join("\n");
drawWheel();

</script>
</body>
</html>
